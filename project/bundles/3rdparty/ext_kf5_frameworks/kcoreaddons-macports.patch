diff --git a/src/lib/util/ksignalhandler.cpp b/src/lib/util/ksignalhandler.cpp
index 1a644805..272f0f9e 100644
--- a/src/lib/util/ksignalhandler.cpp
+++ b/src/lib/util/ksignalhandler.cpp
@@ -13,6 +13,7 @@
 #include <signal.h>
 #include <sys/socket.h>
 #include <unistd.h>
+#include <fcntl.h>
 #endif
 
 class KSignalHandlerPrivate : public QObject
@@ -34,7 +35,8 @@ KSignalHandler::KSignalHandler()
 {
     d->q = this;
 #ifndef Q_OS_WIN
-    if (::socketpair(AF_UNIX, SOCK_STREAM | SOCK_CLOEXEC, 0, KSignalHandlerPrivate::signalFd)) {
+    int fd = ::socketpair(AF_UNIX, SOCK_STREAM, 0, KSignalHandlerPrivate::signalFd);
+    if (fcntl(fd, O_CLOEXEC) == -1) {
         qCWarning(KCOREADDONS_DEBUG) << "Couldn't create a socketpair";
         return;
     }
